---
title: "EPL Survivor Analysis"
author: "Divine Amanluoghe"
date: "2026-01-09"
output:
  pdf_document: default
  word_document: default
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Introduction & Objectives**

This report analyzes the competitive dynamics of the nine Premier League clubs that successfully maintained their top-flight status continuously between the 2013/14 and 2023/24 seasons.The dataset effectively filters for 'survivorship,' excluding clubs that faced relegation.

The objective is to determine what drives performance variation within this surviving cohort. Specifically, the analysis investigates three competing hypotheses:

***Financial Dominance***: Whether the 'Big 6' rely on raw wage expenditure to secure points compared to the mid-table survivors (Everton, West Ham, Crystal Palace).

***Managerial Stability***: Whether keeping a manager for longer tenures yields a 'stability dividend' in points.

***Squad Experience***: Whether investing in older, more experienced players (higher Experience Ratio) provides a competitive edge over younger squads.

The analysis employs OLS regression with Fixed Effects to isolate the impact of 'Club Identity' versus marginal resource allocation


```{r}
main = read.csv("~/Desktop/Ball/Analysis/Master_File.csv")
head(main)
```

**Univariate Analysis**

***Histogram and Summary Of Points ***
```{r}
hist(main$Points,
     main ="Histogram Of Points",
     xlab = "Points",
     ylab = "Frequency")
```

***Histogram and Summary of Wage Ratio ***
```{r}
hist(main$Wage_Ratio,
     main ="Histogram Of Wage Ratio",
     xlab = "Wage Ratio",
     ylab = "Frequency")

```

***Histogram of Experience Index ***
```{r}
hist(main$Experience_Ratio,
     main ="Histogram Of Experience Ratio",
     xlab="Experience Ratio",
     ylab="Player Frequency")
```

***Histogram Of Manager Tenure ***
```{r}
hist(main$Manager_Tenure,
      main ="Histogram Of Manager Tenure",
     xlab="Number Of Days In Charge",
     ylab="Manager Count")
```

***Logarithm Transformation ***
```{r}
main$Log_Manager_Tenure=log(main$Manager_Tenure)
hist(main$Log_Manager_Tenure,main ="Histogram Of Log Manager Tenure")
```

***Summary Statistics Table ***
```{r}
library(e1071) 

my_vars <- c("Points", "Wage_Ratio", "Manager_Tenure", "Experience_Ratio")

get_summary_stats <- function(x) {
  c(
    Mean     = mean(x, na.rm = TRUE),
    Median   = median(x, na.rm = TRUE),
    SD       = sd(x, na.rm = TRUE),
    Min      = min(x, na.rm = TRUE),
    Max      = max(x, na.rm = TRUE),
    Skewness = skewness(x, na.rm = TRUE)
  )
}


stats_matrix <- sapply(main[my_vars], get_summary_stats)

final_table <- t(stats_matrix)
final_table <- round(final_table, 2)

print(final_table)

```
The dataset consists of 9 teams which have survived relagtion  observed over 2013/2014â€“ 2024/2025 season. Preliminary univariate analysis revealed significant skewness in key variables:

The variable ***Manager Tenure** revealed a strong right-skewed distribution. This was confirmed by the descriptive statistics in the summary statistics table, which showed a high skewness value of 3.16.
Indicating that long-serving managers are rare outliers
Consequently, a Log transformation was applied to normalize the variable for regression analysis.

***Wage Ratio*** displayed a bimodal distribution, likely reflecting the financial stratification between 'Top 6' clubs and Mid-table Survivors(Everton, Crystal Palace, West Ham). However, as the skewness was low (0.21), the variable was preserved in its raw form to maintain interpretability. 

***Experience Ratio*** was found to be approximately normal (-0.31) indicating that squad age profiles are relatively consistent across both the 'Big 6' and the 'Survivor 3' and required no transformation.

**Bivariate Analysis**

***Boxplot of Points grouped by Teams***
```{r}
library(ggplot2)
ggplot(main, aes(x = Team.Name, y = Points, fill = Team.Name)) +
  geom_boxplot() +
  labs(
    title = "Distribution of Points by Team (2013-2024)",
    x = "Team",
    y = "Points"
  )+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
```


***Boxplot of Manager Tenure grouped by Teams***
```{r}
ggplot(main, aes(x = Team.Name, y = Manager_Tenure, fill = Team.Name)) +
  geom_boxplot() +
  scale_y_log10(breaks = c(5,100, 365, 1000, 3000, 7000)) +
  labs(
    title = "Managerial Stability by Teams",
    subtitle = "Y-axis is compressed to show differences in short tenures clearly",
    x = "Team",
    y = "Days in Charge"
  ) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
```

***Boxplot of Wage Ratio By Teams***
```{r}
ggplot(main, aes(x = Team.Name, y = Wage_Ratio, fill = Team.Name)) +
  geom_boxplot() +
  geom_hline(yintercept = 1, linetype = "dashed", color = "red",) +
  labs(
    title = "Financial Power: Wage Ratio by Team",
    subtitle = "1.0 = Average of the 9 Teams(Red Line). Values > 1 indicate outspending the group",,
    x = "Team",
    y = "Wage Ratio (0 = League Avg)"
  )+
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
```

***Boxplot of Experience Ratio By Teams***
```{r}
ggplot(main, aes(x = Team.Name, y = Experience_Ratio, fill = Team.Name)) +
  geom_boxplot() +
  geom_hline(yintercept = 1, linetype = "dashed", color = "red",) +
  labs(
    title = "Squad Experience: Experience Ratio by Team",
       subtitle = "1.0 = Average of the 9 Teams. Values > 1 indicate a more experienced squad.",
       y = "Experience Ratio (Multiplier of Peer Avg)",
       x = "Team") +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
```



***1.)Points vs. Financial Power (The "Diminishing Returns" Check)***

```{r}
ggplot(main, aes(x = Wage_Ratio, y = Points)) +
  geom_point( color = "darkblue") +  # The dots
  geom_smooth(method = "loess", color = "red", size = 1) + 
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, linetype = 2) +
  geom_smooth(method = "lm", formula = y ~ x + I(x^2), se = FALSE, color ="purple", linetype = 3, size =0.8) +
  geom_vline(xintercept = 1.0, linetype = "dashed", color = "black") +
  labs(title = "Comparison of functional forms suggesting potential diminishing returns to wage spending",
       subtitle = "Loess vs Linear vs Quadratic",
       x = "Wage Ratio",
       y = "Points")

model_wage_quad = lm(Points ~Wage_Ratio + I(Wage_Ratio^2), data = main)
summary(model_wage_quad)

wageq.anova=aov(Points ~ Wage_Ratio + I(Wage_Ratio^2), data=main)
wageq.fitted = fitted.values(wageq.anova)
wageq.residuals = residuals(wageq.anova)

# Residual Plot
plot(wageq.fitted,wageq.residuals, xlab = "Fitted Values", ylab = "Residuals")

#QQ Plot
wageq.stdres = rstandard(wageq.anova)
qqnorm(wageq.stdres)
qqline(wageq.stdres)
```


***2.) Points vs. Managerial Stability (The "Patience" Check)***
```{r}
middle_tenure = median(main$Manager_Tenure)


ggplot(main,aes(x=Manager_Tenure, y= Points)) + 
  geom_point(color = "darkgreen") +
  geom_smooth(method = "loess", color = "orange", size = 1.2) +
  geom_vline(xintercept = middle_tenure, linetype ="dashed", color="red")+
  scale_x_log10() + # Used log scale on X axis so short tenures aren't squashed
  labs(title = "Hypothesis 2: Does Patience Pay Off with Points?",
       subtitle =paste("Red Line = Median Tenure (", round(middle_tenure), " Days). Right of line = Above Average Tenure"),
       x = "Days in Charge (Log Scale)",
       y = "Points")


model_tenure = lm(Points ~Log_Manager_Tenure, data = main)
summary(model_tenure)

tenure.anova=aov(Points~Log_Manager_Tenure, data=main)
tenure.fitted = fitted.values(tenure.anova)
tenure.residuals = residuals(tenure.anova)

# Residual Plot
plot(tenure.fitted,tenure.residuals, xlab = "Fitted Values", ylab = "Residuals")

#QQ Plot
tenure.stdres = rstandard(tenure.anova)
qqnorm(tenure.stdres)
qqline(tenure.stdres)
```

***3.)Points Vs. Experience Ratio***
```{r}
ggplot(main,aes(x=Experience_Ratio, y= Points)) + 
  geom_point(color = "purple") +
  geom_smooth(method = "loess", color = "black", size = 1.2) +
    geom_smooth(method = "lm", formula = y ~ x, se = FALSE, linetype = 2) +
  geom_smooth(method = "lm", formula = y ~ x + I(x^2), se = FALSE, color ="yellow", linetype = 3, size =0.8) +
  geom_vline(xintercept = 1.0, linetype = "dashed", color = "red") +
  labs(title = "Investigation of non-linear effects in squad experience (testing for 'Peak Age' efficiency)",       subtitle = "Loess vs Linear vs Quadratic",
       x = "Experience Ratio(1.0 = Peer Average)",
       y = "Points")

model_exp = lm(Points ~ Experience_Ratio, data = main)
summary(model_exp)

exp.anova=aov(Points~Experience_Ratio, data=main)
exp.fitted = fitted.values(exp.anova)
exp.residuals = residuals(exp.anova)

# Residual Plot
plot(exp.fitted,exp.residuals, xlab = "Fitted Values", ylab = "Residuals")

#QQ Plot
exp.stdres = rstandard(exp.anova)
qqnorm(exp.stdres)
qqline(exp.stdres)
```
***Bivariate log wage model***
```{r}
# 1C) Bivariate log wage model
ggplot(main, aes(x = Wage_Ratio, y = Points)) +
  geom_point( color = "darkblue") +  # The dots
  geom_smooth(method = "loess", color = "red", size = 1) + 
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, linetype = 2) +
    geom_smooth(method="lm", formula = y ~ log(x), se=FALSE,color="purple",size =0.8, linetype=3)+
  geom_vline(xintercept = 1.0, linetype = "dashed", color = "black") +
  labs(title = "Wage functional form comparison",
       subtitle = "Loess vs Linear vs Logarithm",
       x = "Wage Ratio",
       y = "Points")

model_wage_log = lm(Points ~log(Wage_Ratio ), data = main)
summary(model_wage_log)

wagelog.anova=aov(Points ~log(Wage_Ratio ), data=main)
wagelog.fitted = fitted.values(wagelog.anova)
wagelog.residuals = residuals(wagelog.anova)

# Residual Plot
plot(wagelog.fitted,wagelog.residuals, xlab = "Fitted Values", ylab = "Residuals")

#QQ Plot
wagelog.stdres = rstandard(wagelog.anova)
qqnorm(wagelog.stdres)
qqline(wagelog.stdres)
```

Visual inspection suggested a stratified league structure. Boxplots of points by team  show distinct competitive tiers, with clubs like Manchester City consistently outperforming peers like Crystal Palace.

Initial bivariate scatterplots tested three hypotheses:


***Diminishing Returns***: A Loess curve fitted to Wages vs. Points suggested a potential non-linear relationship, warranting tests for quadratic effects.


***Stability***: The relationship between Tenure and Points appeared weak, with a low correlation visible in the scatterplot.


***Experience***: The 'Experience Efficiency' plot  hinted that veteran squads might offer slightly better returns on wages, prompting an investigation into interaction effects."

***Interaction Plots***
```{r}
# 1. Binning Manager Stability (Tenure)
main$Stability_Status <- cut(main$Manager_Tenure, 
                             breaks = c(-Inf, 365, 1095, Inf), 
                             labels = c("Chaos (<1yr)", "Building (1-3yrs)", "Established (>3yrs)"))

# 2. Binning Experience (Young vs Veteran)
main$Squad_Maturity <- ifelse(main$Experience_Ratio > median(main$Experience_Ratio), 
                              "Veteran Squad", 
                              "Young Squad")

main$Squad_Maturity <- as.factor(main$Squad_Maturity)
main$Stability_Status <- as.factor(main$Stability_Status)
```

```{r}
ggplot(main, aes(x = log(Wage_Ratio), y=Points, color = Stability_Status))+
  geom_point(alpha=0.4)+
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_manual(values = c("Chaos (<1yr)" = "red", 
                                "Building (1-3yrs)" = "orange", 
                                "Established (>3yrs)" = "darkgreen")) +
  
  labs(title = "The Efficiency Hypothesis: Stability as a Multiplier",
       subtitle = "Do 'Established' managers (Green) get more points for the same wages?",
       x = "Log(Wage Ratio)",
       y = "Points Won",
       color = "Manager Tenure")
```

```{r}

  ggplot(main, aes(x = log(Wage_Ratio), y = Points, color = Squad_Maturity)) +
  geom_point(alpha=0.4) + 
  geom_smooth(method = "lm", se = FALSE,) + 
  scale_color_manual(values = c("Veteran Squad" = "purple", 
                                "Young Squad" = "orange")) +
  
  labs(title = "Experience Efficiency: Do 'Veteran' squads offer better Value?",
       subtitle = "Comparing Points Returns on Wages between Old vs. Young Squads",
       x = "Log(Wage Ratio)",
       y = "Points Won",
       color = "Squad Profile")

```

```{r}
library(ggcorrplot)

main$Log_Wage <- log(main$Wage_Ratio)
main$Log_Tenure <- log(main$Manager_Tenure)

my_predictors <- main[, c("Log_Wage", "Experience_Ratio", "Log_Tenure")]

cor_matrix = cor(my_predictors)

ggcorrplot(cor_matrix, 
           method = "square",      
           type = "lower",          
           lab = TRUE,              
           colors = c("orange", "white", "lightblue"), 
           title = "Multicollinearity Check Matrix")
```
**Regression Models**
***Simple Model***
```{r}
base.lm=lm(Points~Log_Wage+Log_Tenure+Experience_Ratio+Team.Name,
            data =main)
summary(base.lm)

```

**Complex Models**
****Quadratic Model***
```{r}
complex.lm=lm(Points ~ Log_Wage + I(Log_Wage^2)+ Log_Tenure + I(Log_Tenure^2) + Experience_Ratio +Team.Name,
              data = main
)

summary(complex.lm)

```
***Full Complex Model***
```{r}
full.lm=lm(Points ~ Log_Wage + I(Log_Wage^2)+ Log_Tenure + I(Log_Tenure^2) + Experience_Ratio + Log_Wage*Experience_Ratio +Team.Name,
              data = main
)

summary(full.lm)
```
```{r}
library(car)
vif(full.lm)
```
***Base (After VIF Check) Model***
```{r}
main$Log_Tenure_Center <- main$Log_Tenure - mean(main$Log_Tenure)
main$Log_Wage_Center <- main$Log_Wage - mean(main$Log_Wage)
main$Exp_Ratio_Center <- main$Experience_Ratio - mean(main$Experience_Ratio)
base_vif.lm = lm(Points ~ Log_Wage_Center + Log_Tenure_Center + 
                      Exp_Ratio_Center + Team.Name, 
                      data = main)
summary(base_vif.lm)
```

***Complex (After VIF Check) Model***
```{r}

complex_vif.lm=lm(Points ~ Log_Wage_Center + I(Log_Wage_Center^2)+ Log_Tenure_Center + I(Log_Tenure_Center^2) + Exp_Ratio_Center +Team.Name,data = main)

summary(complex_vif.lm)
```

***Full Complex (After VIF Check) Model***
```{r}
full_vif.lm=lm(Points ~ Log_Wage_Center + I(Log_Wage_Center^2)+ Log_Tenure_Center + I(Log_Tenure_Center^2) + Exp_Ratio_Center + Log_Wage_Center*Exp_Ratio_Center +Team.Name,
              data = main
)

summary(full_vif.lm)
```
**Anova Comparisons**
***Base VS Complex***
```{r}
anova(base_vif.lm,complex_vif.lm)
```
***Complex Vs Full***
```{r}
anova(complex_vif.lm,full_vif.lm)
```
```{r}
library(car)
durbinWatsonTest(base.lm)
```
***Base vs Base without Teams***
```{r}
base_exteam.lm=lm(Points ~Log_Wage_Center + Log_Tenure_Center + 
                      Exp_Ratio_Center, data = main)

summary(base_exteam.lm)

anova(base_vif.lm,base_exteam.lm)

```
To determine the functional form of the relationship, a series of Nested F-tests (ANOVA) were conducted to test for complexity:

***Testing for Diminishing Returns***: A quadratic model (including Log_Wage^2 and Log_Tenure^2 was compared to the Base Linear Model. The ANOVA returned a p-value of 0.3476, failing to reject the null hypothesis. This indicates that adding curvature did not significantly improve model fit.

***Testing for Efficiency (Interactions)***: A Full Model adding a Wage * Experience interaction was tested against the complex model. The p-value was 0.5025. This suggests that experienced squads do not statistically convert wages into points more efficiently than younger squad

The complex terms were dropped in favor of the Base Linear Model.

**Final Model Results**
The final model explains approximately 63% of the variance in points ($R^2 = 0.6318$). The results highlight the dominance of structural factors over marginal decisions:

***The Dominance of Club Identity***: A partial F-test confirmed that including 'Team' as a fixed effect was highly significant ($p < .001$).

***Interpretation of Fixed Effects***: Relative to the baseline (Arsenal), clubs face significant structural starting points. For example, Crystal Palace is predicted to finish  approximately 37 points lower than Arsenal holding all else constant, while Manchester City holds a 13 point structural advantage.

***The Insignificance of Wages***: Once club fixed effects were controlled for, the Log_Wage variable became statistically insignificant ($p = 0.387$). This implies that high wages are a feature of big clubs as to prevent other clubs from poaching their players, not necessarily the direct cause of seasonal variation in points.

**Diagnostics**

Diagnostic checks confirmed the validity of the OLS assumptions. The Q-Q plot showed residuals tracking the normal line, and the Durbin-Watson test confirmed the independence of errors (no autocorrelation), validating the results
The Durbin-Watson test indicated no significant autocorrelation ($\text{DW} = 1.89, p > .05$), confirming that seasonal observations were statistically independent
